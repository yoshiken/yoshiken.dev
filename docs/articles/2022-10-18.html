
<!DOCTYPE html>
<html lang="ja" class="no-js">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width">

  <title>フレッツ光クロス(10Gbps)を導入した</title>

  <script type="module">
    document.documentElement.classList.remove('no-js');
    document.documentElement.classList.add('js');
  </script><!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-28XQFWFFT4"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-28XQFWFFT4');
  </script>

  <!-- Thank you https://picturepan2.github.io/spectre/ -->
  <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
  <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
  <!-- Custom styles for improved design -->
  
  <link rel="stylesheet" href="../custom.css">
  
  <style>
    /* Legacy word-wrap for links */
    a {
      word-wrap: break-word;
    }

    /* Blog title styling */
    .blog-title a,
    .blog-title a:visited,
    .blog-title a:hover,
    .blog-title a:active {
      color: inherit;
      text-decoration: none;
    }
  </style>
  <meta name="description" content=令和のインターネットがようやくきた～～～～～～～～～>
  
  <meta property="og:title" content="フレッツ光クロス(10Gbps)を導入した">
<meta property="og:site_name" content="yoshiken.dev" />
<meta property="og:description" content="令和のインターネットがようやくきた～～～～～～～～～">
<meta property="og:image" content="https://yoshiken.dev/ogp.png">
<meta property="og:locale" content="ja_JP">
<meta property="og:type" content="article">
<meta name="twitter:card" content="summary">
<meta property="og:url" content="https://yoshiken.dev/articles/2022-10-18">
  
  <link rel="canonical" href=https://yoshiken.dev/articles/2022-10-18>
  <link rel="icon" href="https://yoshiken.dev/favicon.icon">
  <meta name="theme-color" content="#CCFFFF">
</head>

<body>
  <div class="container">
      <div class="columns">
            <div class="column col-10 col-mx-auto">
                  <header>
                        <div class="blog-title">
                              <h1><a href="/">yoshiken.dev</a></h1>
                        </div>
                        <p>yoshikenがプログラミングや日記、ポエムを書いていくページです</p>
                  </header>
                  <hr>
            </div>
      </div>
</div>
  <div class="container">
    <div class="columns">
      <div class="column col-12">
        <div class="article-container">
          <article class="article-content">
            <header>
              <h1>フレッツ光クロス(10Gbps)を導入した</h1>
              <time datetime="2022-10-18 08:40:02+09:00">2022-10-18</time>
            </header>
            <div class="article-body">
              <h2>1Gbpsは平成までだよね～</h2>
<h3>引っ越しました</h3>
<p>職場まで1時間ぐらいかかってて中々にしんどかったので引っ越しをした。職場まで大体30分くらい。</p>
<p>で、引っ越しついでにVDSLに限界を感じてたので10Gbps感じて～とか思ってたので光配線方式のマンションを探した。</p>
<p>結構時間かかったが光配線方式のマンションで駅チカが見つかり10Gbpsを引くことにした。</p>
<h3>NURO光ではなくフレッツ光にした</h3>
<p>NURO光は出はじめ頃に使っててかなり体験よかったけど、最近人口増えてあんまり良い噂聞かないしそもそもNTTの光ファイバーと併用できないのでau光かフレッツ光クロスの選択肢から今回はフレッツ光クロスを選択した。</p>
<p>ちなみにプロパイダーは申込時でフレッツ光クロス×マンションタイプはASAHIネットしか選択肢しかなかった。</p>
<p>賃貸契約結んで開通まではwifiレンタルどっとこむでwimaxのレンタルホームルーターで凌いでいた。下り60Mbps/上り2Mbpsでオンライン会議できんのかなぁと思ってたけど案外いけた。zoomさんすげーっす。</p>
<h3>そもそもPCが対応してなかった</h3>
<p>開通までに色々準備しなくてはいけなくて、前述通り前の部屋ではVDSLで理論値100Mbpsしか出なかったので1Gbpsの環境しかなく、まず10Gbps対応のNICを探すところから始めた。</p>
<p>ざっくりネットで検索したり、用事があって寄った秋葉原のドスパラの店員さんと話をして<a href="https://www.asus.com/jp/Networking-IoT-Servers/Wired-Networking/All-series/XG-C100C/">XG-C100C/v2</a>を買うことにした。今のところPCパーツでASUSでハズレを引いたことがないという単純な理由。</p>
<p>お次はルーター。要件としてはWANに10Gbps1本、メインPC用にLANに10Gbps最低1本。本当は!0Gbps5本ぐらいぶっ刺せるスイッチングハブ欲しかったんだけどコンシューマー向けだとTP-Link製しかなくTP-Linkはちょっとねぇ…</p>
<p>一応TSUKUMOの店員にも聞いたけどそれしか無いっぽいしそれ以外だと業務用のモデルしかないし、そもそも半導体不足の影響がまだ響いてるらしくあんまり市場に出回ってないとのこと。</p>
<p>しゃーないので適当な無線ルーター買うか～ということで妥協に妥協をしてIODATAの<a href="https://www.iodata.jp/product/network/wnlan/wn-dax3600xr/">WN-DAX3600XR</a>にした。</p>
<p>なんか諸々設定がビミョ～な感じなので暇なときに自作ルーターでも作るかというお気持ちになってしまった。</p>
<p>見た目がイカついASUSUの<a href="https://www.asus.com/jp/Networking-IoT-Servers/WiFi-Routers/ASUS-Gaming-Routers/RT-AX89X/">RT-AX89X</a>でも良かったんだけどLAN側がSFP+っぽくて別に今のところ使う予定ないのでパス。</p>
<p>んで、LANケーブルもCAT.5Aしか無いからCAT.6Aのケーブルを適当にポチポチ</p>
<h3>DHCPv6-PDとAFTRの罠</h3>
<p>まず普通に開通工事過ぎてやるか～って普通に設定したけど全くダメ。</p>
<p>なんでやねんと思って色々いじった結果の結論からいうと</p>
<ol>
<li>フレッツ光ネクストはひかり電話の有無に関わらずDHCPv6-PDでしか配られてこない</li>
<li>AFTRは <code>dslite.v6connect.net</code> にしなくちゃならん。</li>
</ol>
<p>最初公式ページを見に行って</p>
<blockquote>
<p>光クロス回線のサービスをご利用の場合は、「XG-100NE」のみが対応となります。そのため、AsahiNet 光クロスコース、ASAHIネット ドコモ光 10ギガコース、フレッツ 光クロスコース、ASAHIネット 光 with フレッツクロスをご契約のお客様は、レンタルルータのお申し込みをお願いいたします。</p>
</blockquote>
<p>と書いてあり絶望</p>
<p>https://asahi-net.jp/service/ftth/ipv6/4over6.html</p>
<p>そもそもなんでXG-100NEしか対応してないんだろうとぐぐったらこちらのサイトが出てきて色々参考にさせてもらった。</p>
<p><a href="https://blog.ipnet-lab.ne.jp/entry/2020/06/18/002606">フレッツ光クロスを契約してみた - TRY AND ERROR</a></p>
<blockquote>
<p>しかしフレッツ光クロスの場合はDHCPv6-PD方式による「/56」の割当のみとなっています。</p>
</blockquote>
<p>ほぇ～なんでやろ。と思いつつ調べる時間がないというか、早くメインPCに接続させたいので調査するのは保留にして再度設定。誰か教えてクレメンス。</p>
<p>設定後は一応それっぽいグローバルのIPv6が降ってきて <code>ping -6 google.com</code> の疎通も確認できた。</p>
<p>けどIPv4での疎通ができずDS-Liteがうまいこと働いてないのかなぁ～と再度blogを潜る。</p>
<blockquote>
<p>IPv4接続については4over6のDS-Lite方式になります。DS-Liteのトンネル終端アドレス（AFTR）は公開されていないようで、ブロードバンドルータに自動的に配信されるようになっているです。従って、この配信の仕組みに対応しているルータ以外はDS-Liteを利用できなそうです。（現状は「XG-100NE」だけか…）</p>
</blockquote>
<p>ふぇぇぇ～＞＜</p>
<p>なんとかならんかIO DATAの公式ページ見に言ったら「ASAHIネット対応してるけど、てめーのルーターは対応してねーよ」と書いており絶望</p>
<blockquote class="twitter-tweet"><p lang="und" dir="ltr">GG… <a href="https://t.co/TYWZO1CADn">pic.twitter.com/TYWZO1CADn</a></p>&mdash; 六本木JK@17歳 (@yoshiken_tut) <a href="https://twitter.com/yoshiken_tut/status/1578336323148034056?ref_src=twsrc%5Etfw">October 7, 2022</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>ここでルーター変えるか…と悩んでいたら、ふと「ん？今まで調べてたのは"ASAHINet光クロス"であって、"光フレッツクロスでISPがASAHI光"なので別にISP制約はそんなに関係ないのでは？」と気付き普通に光フレッツクロスの設定方法をググったらAFTRを <code>dslite.v6connect.net</code> にしろって書いてあって、あっけなく解決した。</p>
<p>"CPUがサチってるからCPU増設したけど結局メモリのGCが原因でした"みたいなオチ。</p>
<p>結果</p>
<p><img src="https://i.imgur.com/JC6c4kW.png" alt=""></p>
<p>まぁまぁ満足。</p>
<p>たまに上りが不安定にはなって100~150Mbpsになる時はあるけど前に比べて全然快適。</p>
<p>インターネットサイコー！</p>
            </div>
          </article>
        </div>
      </div>
    </div>
  </div>
  <footer>
  <div class="container">
    <div class="columns">
      <div class="column col-3 col-mx-auto">
        <a href="/">HOME</a> / <a href="/about">About</a> / <a href="https://github.com/yoshiken">Github</a>
      </div>
    </div>
  </div>
</footer>
</body>